<!DOCTYPE html>
<html>
    <h1>植生牆物聯網系統</h1>
    <head>
        <meta charset="utf-8">
        <title>植生牆</title>
        <link href="style2.css" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300&display=swap" rel="stylesheet">
        <!--<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>  <!--連到jquery-->
    </head>
    <body>       
        <div style="text-align:center;" id="Pageswitching">
            <span><input type="button"  value="       首頁       "  class="home"      id="home"      onclick="gohomepage()"></span>
            <span><input type="button"  value="     控制系統     "  class="control"   id="control"   onclick="gocontrolpage()"></span>
            <span><input type="button"  value="   即時數據監測   "  class="nowdata"   id="nowdata"   onclick="gonowdatapage()"></span>
            <span><input type="button"  value="     歷史數據     "  class="histdata"  id="histdata"  onclick="gohistdatapage()"></span>
        </div>

        <div id=homepage>
            <span>黃紫娟你好~ ~ 你居然會點到這個網站 :D</span>
            <span>2025/05/16</span>
            <img src="plantwall.gif" alt="plant wall image" style="display:block; margin:auto; border:5px solid #010f14e7;" width="500px">
        </div>

        <div id=controlpage style="height: 70vh;" >
            <h2>控制系統</h2>
            <div style="background-color: rgba(255, 255, 255, 0.438); width: 1000px; margin: 0 auto;">
                <div id="bb">
                    <p style="color:rgb(72, 1, 105) ; font-size:30px; font-weight:bolder;">選擇模式</p>
                    <select id="SelectTheMode" name="SelectTheMode" style="font-size:21px;">
                        <option value=" " >  選擇模式 </option>
                        <option value="1" > 1.定時模式 </option>
                        <option value="2" > 2.自動模式 </option>
                        <option value="3" > 3.網頁手動 </option>
                        <option value="4" > 4.展示模式 </option>
                    </select>
                    <p style="color:rgb(72, 1, 105) ; font-size:30px; font-weight:bolder;">抽水馬達開關</p>
                    <div class="onoffswitch">
                        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" tabindex="0" onclick="a()">
                        <label class="onoffswitch-label" for="myonoffswitch">
                            <span class="onoffswitch-inner" ></span>
                            <span class="onoffswitch-switch"></span>
                        </label>               
                        <!--<select id="MotorOnOff" name="MotorOnOff" style="font-size:21px;">
                            <option value=" " id="motorop1">抽水馬達開關</option>
                            <option value="1" id="motorop2">開啟</option>
                            <option value="0" id="motorop3">關閉</option>
                        </select>-->
                    </div>
                    <p style="color:rgb(72, 1, 105) ; font-size:30px; font-weight:bolder;">照明燈開關</p>
                    <div class="onoffswitch2">
                        <input type="checkbox" name="onoffswitch2" class="onoffswitch-checkbox2" id="myonoffswitch2" tabindex="0" onclick="b()">
                        <label class="onoffswitch-label2" for="myonoffswitch2">
                            <span class="onoffswitch-inner2" ></span>
                            <span class="onoffswitch-switch2"></span>
                        </label>
                    <!--<select id="LightOnOff" name="LightOnOff" style="font-size:21px;">
                        <option value=" " id="lightop1">照明燈開關</option>
                        <option value="1" id="lightop1">開啟</option>
                        <option value="0" id="lightop1">關閉</option>
                    </select>-->                        
                    </div>
                    <p><button onclick="update()" class="update" id="update">UPDATE</button></p>
                </div>
                <div id=cc> </div>               
            </div>           
        </div>

        <div id=histdatapage>
            <h2>歷史數據</h2>
        <div style="background-color: rgba(255, 255, 255, 0.438); width: 1200px; margin: 0 auto;">
            <div style="display: inline-block; text-align: center; padding: 0 0 0 140px;">           
                <p>空氣濕度</p>
                <iframe width="450" height="260" style="border: 3px solid #0c4105;" src="https://thingspeak.com/channels/1395814/charts/1?bgcolor=%23f5f5f5&color=%231746a2&days=1&dynamic=true&results=240&title=Humid&type=line&xaxis=time&yaxis=data%28%25%29"></iframe>
            </div>
            <div style="text-align: center; float:right; padding: 0 140px 0 0;">
                <p>環境溫度</p>
                <iframe width="450" height="260" style="border: 3px solid #0c4105;" src="https://thingspeak.com/channels/1395814/charts/2?bgcolor=%23f5f5f5&color=%23ea6c7a&days=1&dynamic=true&results=240&title=Temperature&type=line&xaxis=time&yaxis=%2AC"></iframe>
            </div>
            <div style="display: inline-block; text-align: center; padding: 0 0 0 140px;">
                <p>水箱水位</p>
                <iframe width="450" height="260" style="border: 3px solid #0c4105;" src="https://thingspeak.com/channels/1395814/charts/3?bgcolor=%23f5f5f5&color=%231fbc42&days=1&dynamic=true&results=240&title=WaterLevel&type=line&xaxis=time&yaxis=data%28%25%29&yaxismax=100&yaxismin=0"></iframe>
            </div>
            <div style="text-align: center; float:right; padding: 0 140px 0 0;">
                <p>海綿濕度</p>
                <iframe width="450" height="260" style="border: 3px solid #0c4105;" src="https://thingspeak.com/channels/1395814/charts/4?bgcolor=%23f5f5f5&color=%23e2c546&days=1&dynamic=true&results=800&title=Moisture&type=line&xaxis=time&yaxis=data%28%25%29&yaxismax=100&yaxismin=0"></iframe>
            </div>
            <div style="display: inline-block; text-align: center; padding: 0 0 40px 140px;">
                <p>光照狀態</p>
                <iframe width="450" height="260" style="border: 3px solid #0c4105;" src="https://thingspeak.com/channels/1395814/charts/6?bgcolor=%23f5f5f5&color=%23000000&days=1&dynamic=true&results=16000&title=LightState&type=spline&xaxis=time&yaxis=on%2Foff"></iframe>
            </div>
            <div style="text-align: center; float:right; padding: 0 140px 40px 0;">
                <p>馬達狀態</p>
                <iframe width="450" height="260" style="border: 3px solid #0c4105;" src="https://thingspeak.com/channels/1395814/charts/5?bgcolor=%23f5f5f5&color=%23000000&days=1&dynamic=true&results=800&title=MotorState&type=spline&xaxis=time&yaxis=on%2Foff"></iframe>
            </div>
        </div>
        </div>
        
        <div id=nowdatapage style="height: 70vh;">
            <h2>即時數據監測</h2>
            <div id=aa> </div>          
        </div>

        <script>
            document.getElementById("controlpage").style.display="none"; //隱藏div
            document.getElementById("nowdatapage").style.display="none";
            document.getElementById("histdatapage").style.display="none";
            
            var i = 0;               
            function a(){
                if(i==0){
                    alert("Turn on the motor");
                    i=1;
                }
                else if(i==1){
                    alert("Turn off the motor");
                    i=0;
                }
            }

            var j = 0;               
            function b(){
                if(j==0){
                    alert("Turn on the light");
                    j=1;
                }
                else if(j==1){
                    alert("Turn off the light");
                    j=0;
                }
            }

            function update(){
                $.post("https://api.thingspeak.com/update.json",{
                api_key: "UQRL180GJ67UB0U0",
                field1: $('#SelectTheMode').val(),
                field2: i,
                field3: j //上傳控制參數到ThingSpeak
                });
                
                alert('update sucessful!');
                $("#update").attr("disabled",true);
                setTimeout(function(){
                    $("#update").removeAttr("disabled");
                },15000); //15秒內不能點擊


            }

            function gohomepage(){
                document.getElementById("homepage").style.display=""; //顯現div
                document.getElementById("controlpage").style.display="none"; //隱藏div
                document.getElementById("nowdatapage").style.display="none";
                document.getElementById("histdatapage").style.display="none";
            }

            function gocontrolpage(){
                document.getElementById("controlpage").style.display="";
                document.getElementById("homepage").style.display="none";
                document.getElementById("nowdatapage").style.display="none";
                document.getElementById("histdatapage").style.display="none";
            }

            function gonowdatapage(){
                document.getElementById("nowdatapage").style.display="";
                document.getElementById("homepage").style.display="none";
                document.getElementById("histdatapage").style.display="none";
                document.getElementById("controlpage").style.display="none";
            }

            function gohistdatapage(){
                document.getElementById("histdatapage").style.display="";
                document.getElementById("homepage").style.display="none";
                document.getElementById("nowdatapage").style.display="none";
                document.getElementById("controlpage").style.display="none";
            }
            
            var myVVar = setInterval( function() { getDData() } ,10000 )                
            function getDData() {
                document.getElementById("cc").innerHTML = "";  //清空畫面文字
                $.ajax({
                    url:"https://api.thingspeak.com/channels/1421029/feeds/last.json?key=2WU49LRDWIQ0QMPT",
                    type: "GET",
                    dataType: "json",
                    success: function(data){
                        $("#cc").append( "<h4>目前模式 : " + data.field1 + "</h4>");
                    }
                })
                $.ajax({
                    url:"https://api.thingspeak.com/channels/1421029/feeds/last.json?key=2WU49LRDWIQ0QMPT",
                    type: "GET",
                    dataType: "json",
                    success: function(data){
                        $("#cc").append();
                    }
                })
                $.ajax({
                    url:"https://api.thingspeak.com/channels/1395814/feeds/last.json?key=0QPY4GY9VZSSRCF0",
                    type: "GET",
                    dataType: "json",
                    success: function(data){
                        $("#cc").append( "<h4>馬達狀態 : " + data.field5 + "</h4>");
                        $("#cc").append( "<h4>光照狀態 : " + data.field6 + "</h4>");
                    }
                })                
            }

            var myVar = setInterval( function() { getData() } ,10000 )                
            function getData() {
                document.getElementById("aa").innerHTML = "";  //清空畫面文字
                $.ajax({
                    url:"https://api.thingspeak.com/channels/1395814/feeds/last.json?key=0QPY4GY9VZSSRCF0",
                    type: "GET",
                    dataType: "json",
                    success: function(data){
                        $("#aa").append( "<h3>資料標籤 : " + data.entry_id + "</h3>");
                        $("#aa").append( "<h3>環境濕度 : " + data.field1 + "%</h3>");
                        $("#aa").append( "<h3>環境溫度 : " + data.field2 + "℃</h3>");
                        $("#aa").append( "<h3>水箱水位 : " + data.field3 + "%</h3>");
                        $("#aa").append( "<h3>海綿濕度 : " + data.field4 + "%</h3>");
                    }
                })
            }
        </script>
    </body>
</html>
